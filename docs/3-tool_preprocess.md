# Tool Preprocess

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-tool.preprocess.list_images-start--->
## [tool.preprocess.list_images](3-tool_preprocess.md#tool.preprocess.list_images)

<!---Documatic-section-list_images-start--->
<!---Documatic-block-tool.preprocess.list_images-start--->
<details>
	<summary><code>tool.preprocess.list_images</code> code snippet</summary>

```python
def list_images(directory):
    images = []
    for file in listdir(directory):
        name = file.lower()
        if name.endswith('.png'):
            images.append(join(directory, file))
        elif name.endswith('.jpg'):
            images.append(join(directory, file))
        elif name.endswith('.jpeg'):
            images.append(join(directory, file))
    return images
```
</details>
<!---Documatic-block-tool.preprocess.list_images-end--->
<!---Documatic-section-list_images-end--->

# #
<!---Documatic-section-tool.preprocess.list_images-end--->

<!---Documatic-section-tool.preprocess.main-start--->
## [tool.preprocess.main](3-tool_preprocess.md#tool.preprocess.main)

<!---Documatic-section-main-start--->
```mermaid
flowchart LR
tool.preprocess.main-->tool.preprocess.list_images
```

### Object Calls

* [tool.preprocess.list_images](3-tool_preprocess.md#tool.preprocess.list_images)

<!---Documatic-block-tool.preprocess.main-start--->
<details>
	<summary><code>tool.preprocess.main</code> code snippet</summary>

```python
def main(dir_path):
    warnings.filterwarnings('error')
    warnings.filterwarnings('ignore', category=DeprecationWarning)
    paths = list_images(dir_path)
    print('\nOrigin files number: %d\n' % len(paths))
    num_delete = 0
    for path in paths:
        is_continue = False
        try:
            image = imread(path, mode='RGB')
        except Warning as warn:
            is_continue = True
            num_delete += 1
            remove(path)
            print('>>> Warning happens! Removes image <%s>' % path)
            print('Warning detail:\n%s\n' % str(warn))
        except Exception as exc:
            is_continue = True
            num_delete += 1
            remove(path)
            print('>>> Exception happens! Removes image <%s>' % path)
            print('Exception detail:\n%s\n' % str(exc))
        if is_continue:
            continue
        if len(image.shape) != 3 or image.shape[2] != 3:
            num_delete += 1
            remove(path)
            print('>>> Found an image with shape: %s; Now removes it: <%s>\n' % (str(image.shape), path))
        else:
            (height, width, _) = image.shape
            if height < width:
                new_height = 512
                new_width = int(width * new_height / height)
            else:
                new_width = 512
                new_height = int(height * new_width / width)
            try:
                image = imresize(image, [new_height, new_width], interp='nearest')
            except:
                num_delete += 1
                remove(path)
                print('>>> Fails to resize an image! Now removes it: <%s>\n' % path)
                traceback.print_exception(*sys.exc_info())
    print('\n>>>>> delete %d files! Current number of files: %d\n' % (num_delete, len(paths) - num_delete))
```
</details>
<!---Documatic-block-tool.preprocess.main-end--->
<!---Documatic-section-main-end--->

# #
<!---Documatic-section-tool.preprocess.main-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)